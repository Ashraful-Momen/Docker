To dynamically proxy pass requests from an Nginx container to multiple Laravel replicas in a Docker Swarm environment, you can leverage Docker's internal DNS and load balancing capabilities. Docker Swarm provides built-in service discovery and load balancing, which makes it easy to distribute traffic across multiple replicas of your Laravel application.

Here’s how you can achieve this:

### 1. **Set up the Docker Swarm Services**

First, ensure that both the Nginx service and the Laravel service are running in the same Docker Swarm network. You can create an overlay network for this purpose.

```bash
docker network create --driver overlay my_overlay_network
```

Then, deploy the services:

#### Laravel Service (with 10 replicas)
```bash
docker service create \
  --name laravel_app \
  --replicas 10 \
  --network my_overlay_network \
  -p 9000:9000 \
  your_laravel_image
```

#### Nginx Service
```bash
docker service create \
  --name nginx_proxy \
  --network my_overlay_network \
  -p 80:80 \
  your_nginx_image
```

### 2. **Nginx Configuration**

In the Nginx container, you need to configure the `proxy_pass` directive to forward requests to the Laravel service. Since Docker Swarm handles service discovery and load balancing internally, you can simply use the service name (`laravel_app`) as the upstream server.

Here’s an example Nginx configuration:

```nginx
server {
    listen 80;

    server_name your-domain.com;

    location / {
        proxy_pass http://laravel_app:9000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### Explanation:
- **`proxy_pass http://laravel_app:9000;`**: This tells Nginx to forward requests to the `laravel_app` service on port `9000`. Docker Swarm will automatically load balance the requests across all 10 replicas of the Laravel service.
  
- **Service Discovery**: Docker Swarm resolves the `laravel_app` service name to the correct IP addresses of the running replicas. It also handles the load balancing between the replicas.

### 3. **Docker Swarm Load Balancing**

Docker Swarm has built-in load balancing. When you specify `laravel_app` as the upstream in Nginx, Docker Swarm will automatically distribute the incoming requests across all available replicas of the `laravel_app` service. You don’t need to manually manage IP addresses or ports.

### 4. **Optional: Health Checks and Scaling**

You can also add health checks to your Laravel service to ensure that only healthy replicas receive traffic:

```bash
docker service create \
  --name laravel_app \
  --replicas 10 \
  --network my_overlay_network \
  --health-cmd="curl -f http://localhost:9000/health || exit 1" \
  -p 9000:9000 \
  your_laravel_image
```

This ensures that Docker Swarm only routes traffic to replicas that are passing the health check.

### 5. **Scaling Laravel Replicas**

If you want to scale the number of Laravel replicas dynamically, you can use the following command:

```bash
docker service scale laravel_app=15
```

Docker Swarm will automatically update the load balancing to include the new replicas.

### Summary

- **Nginx** acts as a reverse proxy and forwards requests to the `laravel_app` service.
- **Docker Swarm** handles service discovery and load balancing between the Laravel replicas.
- You don’t need to manually manage IP addresses or ports; Docker Swarm takes care of it for you.

This setup ensures that your Nginx container dynamically proxies requests to the Laravel replicas, leveraging Docker Swarm's built-in load balancing and service discovery.
